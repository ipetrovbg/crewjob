(function(){  var app = angular.module('crewjob');    var ModalProjectCloseCtrl = function($scope, $uibModalInstance, item, projectServices, toastinoService, userServices){        $('.loading').hide();        $scope.getRating = function(uid, pid, rating){            if(rating){                userServices.rate(uid, pid, rating)                    .success(function(response){                        if(response.status){                            toastinoService.makeSuccessToast('Успешно оценихте потребителя!', 'long');                        }else{                            toastinoService.makeWarningToast("Този потребител е оценен!", 'long');                        }                    }).error(function(){                    toastinoService.makeDangerToast('Нещо се обърка, моля опитайте отново!', 'long');                });            }else{                toastinoService.makeWarningToast("Изберете рейтинг от 1 до 10!", 'long');            }        };        $scope.rating = [];        projectServices.getProjectApply(item)            .success(function(response){                $('.loading').hide();                if(response.status){                    $scope.projectApply = response.apply;                    angular.forEach(response.apply, function(v, i){                        $scope.rating[i] = {                            rating : response.apply[i].rating,                            basedOn : 10,                            starsCount : 10,                            iconClass : 'fa fa-star',                            editableRating : true,                            showGrade : true                        };                    });                }else{                    toastinoService.makeWarningToast("Нещо се обърка, моля опитайте отново!", 'long');                }            }).error(function(){            $('.loading').hide();            toastinoService.makeDangerToast("Нещо се обърка, моля опитайте отново!", 'long');        });        $scope.cancel = function () {            $uibModalInstance.dismiss('cancel');        };        $scope.final = function(id){            projectServices.final(id)                .success(function(response){                    if(response.status){                        if(response.final){                            toastinoService.makeSuccessToast('Успешно финализирахте проекта!', 'long');                            $uibModalInstance.close();                        }else{                            toastinoService.makeWarningToast("Има неоценени потребители в проекта!", 'long');                        }                    }else{                        toastinoService.makeWarningToast("Нещо се обърка, моля опитайте отново!", 'long');                    }                }).error(function(){                toastinoService.makeDangerToast("Нещо се обърка, моля опитайте отново!", 'long');            });        }    };    app.controller('ModalProjectCloseCtrl', ModalProjectCloseCtrl);}());