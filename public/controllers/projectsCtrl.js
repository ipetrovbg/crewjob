(function(){  var app = angular.module('crewjob');    var projectsCtrl = function($scope, projectServices, categoriesServices){        $scope.busy = false;        $scope.category = '';        projectServices.getAll()            .success(function(response){                //console.log(response);                if(response.status){                    $scope.Projects = response.all_projects;                    $scope.loadMoreProjects = function(){                        if ($scope.busy) return;                            $scope.busy = true;                        var last = $scope.Projects[$scope.Projects.length - 1];                        $scope.lastID = last.id;                        projectServices.getLimitProjects(last.id, $scope.category)                            .success(function(response){                                if(response.limited_projects){                                    for(var i = 0; i < response.limited_projects.length; i++ ){                                        $scope.Projects.push(response.limited_projects[i]);                                    }                                    $scope.busy = false;                                }                            }).error(function(reason){                        });                    };                    //$scope.$emit('list:filtered');                }            }).error(function(reason){            console.log(reason);        });        categoriesServices.getAll()            .success(function(response){                $scope.categories = response.categories;                angular.element(document).find('#cat').dropdown();            }).error(function(reason){            console.log(reason);        });        $("#cat").on("change", function() {            $scope.busy = false;            $scope.category = $(this).val();            console.log($scope.category);            projectServices.getByCategory($scope.category)                .success(function(response){                    //if(response.limited_projects){                    //    for(var i = 0; i < response.limited_projects.length; i++ ){                    //        $scope.Projects.push(response.limited_projects[i]);                    //    }                    //    $scope.busy = false;                    //}                    $scope.Projects = response.limited_projects;                    $scope.loadMoreProjects = function(){                        if ($scope.busy) return;                        $scope.busy = true;                        var last = $scope.Projects[$scope.Projects.length - 1];                        $scope.lastID = last.id;                        console.log(last.id);                        projectServices.getLimitProjects(last.id, $scope.category)                            .success(function(response){                                if(response.limited_projects){                                    for(var i = 0; i < response.limited_projects.length; i++ ){                                        $scope.Projects.push(response.limited_projects[i]);                                    }                                    $scope.busy = false;                                }                            }).error(function(reason){                        });                    };                }).error(function(reason){            });        });    };    app.controller('projectsCtrl', projectsCtrl );}());